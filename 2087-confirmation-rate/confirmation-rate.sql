# Write your MySQL query statement below
select final.user_id,case when  (round(final.confirmed/final.total,2)) is null then 0 else  (round(final.confirmed/final.total,2)) end as confirmation_rate from (select distinct s.user_id, result.total, result.confirmed from Signups as s left join (select total.user_id,total.total, confirmed.confirmed from (select c.user_id,count(*) as total from Confirmations as c group by user_id)as total left join (select c.user_id, count(*) as confirmed from Confirmations as c where action = 'confirmed' group by c.user_id) as confirmed on confirmed.user_id = total.user_id) as result on s.user_id = result.user_id) as final;